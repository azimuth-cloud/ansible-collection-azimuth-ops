---

# The ingress class to use for admin dashboard ingresses
admin_dashboard_ingress_class_name: nginx

# Labels for admin dashboard ingresses
#   The default labels
admin_dashboard_ingress_labels_defaults:
  app.kubernetes.io/managed-by: azimuth-ops
#   Additional labels
admin_dashboard_ingress_labels_overrides: {}
#   The dashboard labels
admin_dashboard_ingress_labels: >-
  {{-
    admin_dashboard_ingress_labels_defaults |
      combine(admin_dashboard_ingress_labels_overrides)
  }}

#Â TLS configuration for admin dashboard ingresses
#   Indicates whether TLS should be enabled
admin_dashboard_ingress_tls_enabled: "{{ ingress_tls_enabled | default(True) }}"
#   TLS-specific annotations
admin_dashboard_ingress_tls_annotations: "{{ ingress_tls_annotations | default({}) }}"
#   Wildcard TLS certificate, if available
admin_dashboard_ingress_tls_wildcard_certificate: >-
  {{ ingress_tls_wildcard_certificate | default(None) }}
admin_dashboard_ingress_tls_wildcard_key: >-
  {{-
    ingress_tls_wildcard_key
    if ingress_tls_wildcard_key is defined
    else undef(hint = 'admin_dashboard_ingress_tls_wildcard_key is required')
  }}
#   The TLS secret name when a wildcard certificate is used
admin_dashboard_ingress_tls_wildcard_secret_name: admin-dashboard-tls


# The basic auth username to use for admin dashboards
admin_dashboard_ingress_basic_auth_username: admin
# The basic auth password to use for admin dashboards
admin_dashboard_ingress_basic_auth_password: >-
  {{ undef(hint = 'admin_dashboard_ingress_basic_auth_password is required') }}
# The name of the secret in each namespace that will contain basic auth credentials
admin_dashboard_ingress_basic_auth_secret_name: admin-dashboard-auth

# Annotations for the admin dashboard ingresses
admin_dashboard_ingress_annotations_defaults: >-
  {{-
    ingress_annotations |
      default({}) |
      combine(
        admin_dashboard_ingress_tls_annotations
        if admin_dashboard_ingress_tls_enabled
        else {}
      ) |
      combine(
        {
          "nginx.ingress.kubernetes.io/auth-type": "basic",
          "nginx.ingress.kubernetes.io/auth-secret": admin_dashboard_ingress_basic_auth_secret_name,
          "nginx.ingress.kubernetes.io/auth-secret-type": "auth-map",
          "nginx.ingress.kubernetes.io/auth-realm": "Azimuth admin dashboards",
        }
      )
  }}
admin_dashboard_ingress_annotations_overrides: {}
admin_dashboard_ingress_annotations: >-
  {{-
    admin_dashboard_ingress_annotations_defaults |
      combine(admin_dashboard_ingress_annotations_overrides)
  }}

# Settings for the Grafana ingress
#   The namespace for the Grafana ingress
admin_dashboard_ingress_grafana_namespace: monitoring-system
#   The name for the Grafana ingress
admin_dashboard_ingress_grafana_name: grafana
#   The host for the Grafana ingress
admin_dashboard_ingress_grafana_host: >-
  {{-
    "{}.{}".format(ingress_grafana_subdomain, ingress_base_domain)
    if ingress_grafana_subdomain is defined and ingress_base_domain is defined
    else undef(hint = 'admin_dashboard_ingress_grafana_host is required')
  }}
#   The name of the service for the Grafana ingress
admin_dashboard_ingress_grafana_service: kube-prometheus-stack-grafana
#   The name of the service port for the Grafana ingress
admin_dashboard_ingress_grafana_port: http-web
#   The name of the secret containing the certificate for the Grafana ingress
admin_dashboard_ingress_grafana_tls_secret_name: >-
  {{-
    admin_dashboard_ingress_tls_wildcard_secret_name
    if admin_dashboard_ingress_tls_wildcard_certificate
    else admin_dashboard_ingress_grafana_name ~ '-tls'
  }}
#   The ingress definition for the Grafana ingress
admin_dashboard_ingress_grafana:
  name: "{{ admin_dashboard_ingress_grafana_name }}"
  namespace: "{{ admin_dashboard_ingress_grafana_namespace }}"
  host: "{{ admin_dashboard_ingress_grafana_host }}"
  service: "{{ admin_dashboard_ingress_grafana_service }}"
  port: "{{ admin_dashboard_ingress_grafana_port }}"
  tls_secret_name: "{{ admin_dashboard_ingress_grafana_tls_secret_name }}"

# The list of ingresses to create
admin_dashboard_ingresses: >-
  {{-
    [
      admin_dashboard_ingress_grafana,
    ] |
      select() |
      list
  }}
